{% extends 'base.html' %}
{% load product_extras %}


{% block title %}My Orders{% endblock %}

{% block content %}

    <h2 class="mb-4">ğŸ“¦ My Orders</h2>

    {% if orders %}
      <div class="row">
        {% for order in orders %}
          <div class="col-md-6 col-lg-4 mb-4">
            <div class="card shadow-sm h-100">
              <div class="card-body">
                <h5 class="card-title">Order #{{ order.id }}</h5>
                <p class="text-muted mb-1">ğŸ“… {{ order.created_at|date:"d M Y, H:i" }}</p>
                <p class="mb-1">ğŸ’° Total: <strong>{{ order.total_price }} $</strong></p>
                <p class="mb-2">ğŸ§¾ Status: <span class="badge bg-info">{{ order.get_status_display }}</span></p>

                <h6 class="mt-3">Products:</h6>
                <ul class="list-unstyled small">
                  {% for pid, qty in order.items.items %}
                    {% with product=pid|get_product %}
                      <li>
                        <a href="{% url 'shop:product_detail' product.slug %}" class="text-decoration-none">
                          <img src="{{ product.image.url }}" alt="{{ product.name }}" width="40" height="40" class="me-2 rounded">
                          {{ product.name }} Ã— {{ qty }} ta
                        </a>
                      </li>
                    {% endwith %}
                  {% endfor %}
                </ul>

                <a href="{% url 'shop:checkout_success' order.id %}" class="btn btn-sm btn-outline-primary mt-3 w-100">
                  ğŸ” View Details
                </a>
              </div>
            </div>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <p>You have no orders yet.</p>
    {% endif %}

{% endblock %}
